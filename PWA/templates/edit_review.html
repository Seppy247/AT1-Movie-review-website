<!DOCTYPE html>
<html>
<head>
    <title>Edit Review - CineVibe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a0a14; color: #fff; }
        .container { max-width: 700px; margin: 3rem auto; padding: 1.5rem; }
        .card { background:#1a1a2e; padding:1.5rem; border-radius:12px; border:1px solid #27273a }
        input[type="text"], textarea, select { width:100%; padding:0.8rem; border-radius:8px; background:#14141f; color:#fff; border:1px solid #27273a }
        button { background: linear-gradient(135deg,#eab308 0%,#fbbf24 100%); color:#0a0a14; padding:0.6rem 1rem; border-radius:8px; border:none; font-weight:700 }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üé¨ CineVibe</div>

        <div class="card">
            <h1>Edit Review</h1>

            <form method="post" enctype="multipart/form-data">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                <div class="form-group">
                    <label for="title">Movie Title</label>
                    <input type="text" id="title" name="title" value="{{ review['title'] }}" required>
                </div>

                <div class="form-group">
                    <label for="film">Select Film</label>
                    <select id="film" name="film_id" required onchange="toggleNewFilmEdit(this.value)">
                        <option value="">Select film</option>
                        {% for film in films %}
                            <option value="{{ film['id'] }}" {% if film['id'] == review['film_id'] %}selected{% endif %}>{{ film['title'] }}</option>
                        {% endfor %}
                        <option value="new">‚ûï Add new film...</option>
                    </select>
                    <div id="newFilmWrapperEdit" style="margin-top:0.75rem; display:none;">
                        <input type="text" id="newFilmEdit" name="new_film" placeholder="Enter new film title" style="width:100%; padding:0.75rem; border-radius:8px; background:#14141f; border:1px solid #27273a; color:#fff;">
                    </div>
                </div>

                <div class="form-group">
                    <label for="rating">Rating</label>
                    <select id="rating" name="rating" required>
                        <option value="">Select your rating</option>
                        {% for r in range(1,6) %}
                            <option value="{{ r }}" {% if r == review['rating']|int %}selected{% endif %}>{{ r }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="content">Your Review</label>
                    <textarea id="content" name="content" required>{{ review['content'] }}</textarea>
                </div>

                <div class="form-group">
                    <label>Current Photo</label>
                    {% if review['photo'] %}
                        <div style="margin-bottom:0.75rem"><img src="{{ url_for('static', filename='uploads/' + review['photo']) }}" alt="photo" style="max-width:200px; border-radius:8px"></div>
                    {% else %}
                        <div style="color:#a1a1aa">No photo uploaded.</div>
                    {% endif %}
                    <label for="photo">Replace Photo (optional)</label>
                    <input type="file" id="photo" name="photo" accept="image/*">
                </div>

                <button type="submit">Save Changes</button>
            </form>

            <div style="margin-top:1rem;"><a href="{{ url_for('view_review', review_id=review['id']) }}" style="color:#a1a1aa">‚Üê Back to review</a></div>
        </div>
    </div>
</body>
</html>